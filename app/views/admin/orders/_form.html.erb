<%= form_with model: order_form, url: order_form.url, scope: :order_form, method: http_method, local: true do |f| %>
  <% if order_form.errors.any? %>
    <div id="error_explanation" class="alert alert-danger">
      <ul>
        <% order_form.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <h4>依頼品情報</h4>
    <%= f.fields_for :items do |item_form| %><br>
      <%= item_form.label :category_id %>
      <%= item_form.collection_select :category_id, Category.all, :id, :name, { include_blank: "この依頼品を削除する" }, { name: "order_form[category_ids][]", class: "category-select" } %>
      <%= item_form.label :price %>
      <%= item_form.number_field :price %>
      <% if item_form.object.images.attached? %>
        <% item_form.object.images.each do |image| %>
          <%= link_to rails_blob_path(image), target: "_blank" do %>
            <%= image_tag image.variant(resize: "150x150") %>
          <% end %>
        <% end %>
      <% else %>
        <%= image_tag "no_image", size: "150x150" %>
      <% end %>
    <% end %>


    <div class="my-3">
      <%= f.label :note %>
      <%= f.text_area :note %>
    </div>

  <h4>お客様情報</h4>
    <div class="my-3">
      <%= f.label :name %>
      <%= f.text_field :name %>
    </div>

    <div class="my-3">
      <%= f.label :phonenumber %>
      <%= f.telephone_field :phonenumber %>
    </div>

    <div class="my-3">
      <%= f.label :email %>
      <%= f.text_field :email %>
    </div>

    <div class="my-3">
      <%= f.label :address %>
      <%= f.text_field :address %>
    </div>

    <div class="my-3">
      <%= f.label :age %>
      <%= f.number_field :age %>
    </div>

    <div class="my-3">
      <%= f.label :sex %>
      <%= f.select :sex, Customer.sexes_i18n.invert, include_blank: "登録しない" %>
    </div>

    <div class="my-3">
      <%= f.label :shipping_id %>
      <%= f.collection_select :shipping_id, Shipping.all, :id, :name, include_blank: "選択して下さい" %>
    </div>

    <div class="my-3">
      <%= f.label :channel %>
      <%= f.select :channel, Order.channels_i18n.invert %>
    </div>

    <div class="my-3">
      <%= f.label :status %>
      <%= f.select :status, Order.statuses_i18n.invert %>
    </div>

    <div class="my-3">
      <%= f.submit "更新する", id: 'update-order' %>
    </div>
<% end %>